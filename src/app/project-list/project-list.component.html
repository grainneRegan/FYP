
<div class="topnav">
  <a style="font-size: 35px;" >scheduleIt</a>
  <a routerLink="/home-component" >Calender</a>
  <a class="active" >Projects</a>
  <a routerLink="/profile">Profile</a>
  <a (click)="authService.SignOut()">Sign Out</a>
</div>



<div class="row">
  <div class="d-flex justify-content-center align-items-center w-150 mx-auto">
    <!-- Add New Task card -->
    <div *ngIf="isPopupVisible" class="col-md-3">
      <div class="card my-4">
        <div class="card-header">
          <div class="row justify-content-between">
            <div class="col-10 d-flex">
              <h5>Add New Task</h5>
            </div>
            <div class="col-2 d-flex justify-content-end">
              <div class="btn-group">
                <span class="d-inline-block" tabindex="0" data-bs-toggle="tooltip" title="Close">
                  <button type="button" class="btn btn-default" (click)="closePopup()">
                    <i class="bi bi-x-lg" style="font-size: 17px;"></i>
                  </button>
                </span>
              </div>
            </div>
          </div>
        </div>

        <div class="card-body">
          <div class="main">
            <form>
              <div class="mb-3">
                <label for="addItemInput" class="form-label">Task Name</label>
                <input
                  #newItem
                  placeholder="Enter project name"
                  class="form-control"
                  id="addItemInput" />
              </div>

              <div class="mb-3">
                <label for="addItemInput2" class="form-label">Description</label>
                <input
                  #newItem2
                  placeholder="Enter description"
                  class="form-control"
                  id="addItemInput2" />
              </div>

              <div class="mb-3">
                <label for="addItemInput3" class="form-label">Due Date</label>
                <div class="mb-3">
                  <div class="input-group">
                    <input
                      #newItem3
                      class="form-control"
                      placeholder="yyyy-mm-dd"
                      name="dp"
                      [(ngModel)]="model"
                      ngbDatepicker
                      #d="ngbDatepicker"
                    />
                    <span class="d-inline-block" tabindex="0" data-bs-toggle="tooltip" title="Choose Date">
                      <button class="btn btn-outline-secondary bi bi-calendar3" (click)="d.toggle()" type="button"></button>
                    </span>
                  </div>
                </div>
              </div>

              <button type="button" class="btn btn-primary btn-pink" (click)="addTask(newItem.value, newItem2.value, newItem3.value)">Add Task</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="isSubPopupVisible" class="col-md-3">
      <div class="card my-4">
        <div class="card-header">
          <div class="row justify-content-between">
            <div class="col-10 d-flex">
              <h5>Add Subtask</h5>
            </div>
            <div class="col-2 d-flex justify-content-end">
              <div class="btn-group">
                <span class="d-inline-block" tabindex="0" data-bs-toggle="tooltip" title="Close">
                  <button type="button" class="btn btn-default" (click)="closeSubTaskPopup()">
                    <i class="bi bi-x-lg" style="font-size: 17px;"></i>
                  </button>
                </span>
              </div>
            </div>
          </div>
        </div>

        <div class="card-body">
          <div class="main">
            Add a sub task here for new Task {{newProjectName}} ...
            <form>
              <div class="mb-3">
                <label for="addItemInput" class="form-label">Name of Sub Task</label>
                <input
                  #newItem
                  placeholder="Enter task name"
                  class="form-control"
                  id="addItemInput4" />
              </div>

              <div class="mb-3">
                <label for="addItemInput2" class="form-label">Description</label>
                <input
                  #newItem2
                  placeholder="Enter description"
                  class="form-control"
                  id="addItemInput5" />
              </div>

              <button type="button" class="btn btn-primary btn-pink" (click)="addSubTask(newItem.value, newItem2.value)">Add Sub Task</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="isSubPopup2Visible" class="col-md-3">
      <div class="card my-4">
        <div class="card-header">
          <div class="row justify-content-between">
            <div class="col-10 d-flex">
              <h5>Add Subtask</h5>
            </div>
            <div class="col-2 d-flex justify-content-end">
              <div class="btn-group">
                <span class="d-inline-block" tabindex="0" data-bs-toggle="tooltip" title="Close">
                  <button type="button" class="btn btn-default" (click)="closeSubTask2Popup()">
                    <i class="bi bi-x-lg" style="font-size: 17px;"></i>
                  </button>
                </span>
              </div>
            </div>
          </div>
        </div>

        <div class="card-body">
          <div class="main">
            Add a sub task of Task {{newProjectName}} ...
            <form>
              <div class="mb-3">
                <label for="addItemInput" class="form-label">Name of Sub Task</label>
                <input
                  #newItem
                  placeholder="Enter task name"
                  class="form-control"
                  id="addItemInput7" />
              </div>

              <div class="mb-3">
                <label for="addItemInput2" class="form-label">Description</label>
                <input
                  #newItem2
                  placeholder="Enter description"
                  class="form-control"
                  id="addItemInput8" />
              </div>

              <button type="button" class="btn btn-primary btn-pink" (click)="addSubTask(newItem.value, newItem2.value)">Add Sub Task</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- My Tasks card -->
    <div class="col-md-8">
      <div class="card mx-auto my-4 w-75">
        <div class="card-header">
          <div class="row justify-content-between">
            <div class="col-10 d-flex">
              <h4>My Tasks</h4>
            </div>
            <div class="col-2 d-flex justify-content-end">
              <div class="btn-group">
                <span class="d-inline-block" tabindex="0" data-bs-toggle="tooltip" title="Add Task">
                  <button type="button" class="btn btn-default" (click)="showPopup()">
                    <i class="bi bi-plus-circle" style="font-size: 20px;"></i>
                  </button>
                </span>
                <div ngbDropdown class="d-inline-block">
                  <span class="d-inline-block" tabindex="0" data-bs-toggle="tooltip" title="Sort List">
                    <button type="button" class="btn btn-default" id="dropdownBasic1" ngbDropdownToggle>
                      <i class="bi bi-funnel" style="font-size: 20px;"></i>
                    </button>
                  </span>
                  <div ngbDropdownMenu aria-labelledby="dropdownBasic1">
                    <button ngbDropdownItem type="button" class="btn btn-default" (click)="sortTasksByDueDate()">Sort By Due Date</button>
                    <button ngbDropdownItem type="button" class="btn btn-default" (click)="sortTasksByCompleted()">Sort By Completed</button>
                    <button ngbDropdownItem type="button" class="btn btn-default" (click)="sortTasksByImportance()">Sort By Importance</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-body">
            <ul class="list-group">
              <!-- My Tasks card body content -->
              <li class="list-group-item" *ngFor="let project of arrayProjects.slice(1); let i = index" (click)="setActiveUser(project, i)">
                <div class="row align-items-center justify-content-between" >
                  <div class="col-8">
                    <h5 style="color: #75a99c; font-weight: 600;">{{project.projectName}}<span class = 'project-heading'>(due: {{project.date}})</span></h5>
                  </div>
                  <div class="col-4 d-flex justify-content-end">
                    <div class="btn-group">
                      <span class="d-inline-block" tabindex="0" data-bs-toggle="tooltip" title="Add Sub Task">
                        <button type="button" class="btn btn-default" (click)="showSubTask2Popup(project.projectName)">
                          <i class="bi bi-plus-circle" style="font-size: 15px;"></i>
                        </button>
                      </span>
                      <div *ngIf="!project.flagged; else flagged">
                        <span class="d-inline-block" tabindex="0" data-bs-toggle="tooltip" title="Important">
                          <button type="button" class="btn btn-default" (click)="updateTaskFlaggedStatus(project.projectName, true)">
                            <i class="bi bi-star" style="font-size: 15px;"></i>
                          </button>
                        </span>
                      </div>
                      <ng-template #flagged>
                        <span class="d-inline-block" tabindex="0" data-bs-toggle="tooltip" title="Important">
                          <button type="button" class="btn btn-default" (click)="updateTaskFlaggedStatus(project.projectName, false)">
                            <i class="bi bi-star" style="font-size: 15px; color: pink"></i>
                          </button>
                        </span>
                      </ng-template>
                      <div *ngIf="!project.completed; else completed">
                        <div class="button-wrapper">
                          <span class="d-inline-block" tabindex="0" data-bs-toggle="tooltip" title="Mark as Completed">
                            <button type="button" class="btn btn-default confetti-button" (click)="updateTaskCompletedStatus(project.projectName, true); confetti()">
                              <i class="bi bi-check2-circle" style="font-size: 15px;"></i>
                            </button>
                          </span>
                        </div>
                      </div>
                      <ng-template #completed>
                        <span class="d-inline-block" tabindex="0" data-bs-toggle="tooltip" title="Mark as Completed">
                          <button type="button" class="btn btn-default" (click)="updateTaskCompletedStatus(project.projectName, false)">
                            <i class="bi bi-check2-circle" style="font-size: 15px; color: pink"></i>
                          </button>
                        </span>
                      </ng-template>
                      <span class="d-inline-block" tabindex="0" data-bs-toggle="tooltip" title="Delete">
                        <button type="button" class="btn btn-default" (click)="deleteTask(project.projectName)">
                          <i class="bi bi-trash3" style="font-size: 15px;"></i>
                        </button>
                      </span>
                    </div>
                  </div>
                </div>
                {{project.description}}
                <ul>
                  <li *ngFor="let task of project.tasks | orderBy:['completed', 'flagged']">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" [checked]="task.completed" (change)="updateTask(task, project.projectName)">
                      <label class="form-check-label" [class.completed-task]="task.completed">
                        {{ task.taskName }}
                        <span class="task-description">{{ task.description }}</span>
                      </label>
                    </div>
                  </li>
                </ul>

              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

